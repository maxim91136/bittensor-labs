# v1.0.0-rc.7.1: Priority-Weighted MA Strategy

**Release Date:** November 29, 2025

---

## Summary

RC7.1 refines the trend detection algorithm to prioritize structural (1-day) trends over intraday noise. The system now correctly alerts on significant volume declines like the current market situation (250M → 80M volume shift).

### Key Fix

- **1-Day MA is Primary Indicator**: ≤-3% or ≥+3% triggers alert immediately
- **Short-Term MA is Secondary**: Confirms signal when 1-day is weaker (±1-3%)
- **Result**: Structural volume losses are now properly alarmed

---

## Changes

### Backend (`compute_taostats_aggregates.py`)

**New Priority Logic:**

```
IF 1-day ≤ -3%:        DOWN (structural volume loss)
ELSE IF 1-day ≥ +3%:   UP (structural volume gain)
ELSE IF short ≤ -3% AND med ≤ -1%:  DOWN (dual confirmation)
ELSE IF short ≥ +3% AND med ≥ +1%:  UP (dual confirmation)
ELSE:                  NEUTRAL
```

**Why This Works:**
- Catches real trends early (like your -3.41% 1-day MA)
- Doesn't false-alarm on temporary intraday moves
- Balances sensitivity with specificity

### Test Cases (All Passing)

| Scenario | Short | 1-Day | Result | Status |
|----------|-------|-------|--------|--------|
| Current: high loss | -0.31% | -3.41% | DOWN ✓ | ✓ |
| Moderate decline | -0.31% | -1.5% | NEUTRAL | ✓ |
| Short only bad | -3.5% | -0.8% | NEUTRAL | ✓ |
| Both bad | -3.5% | -1.5% | DOWN ✓ | ✓ |
| Strong upturn | +4.5% | +3.5% | UP ✓ | ✓ |
| Med only good | +0.5% | +3.2% | UP ✓ | ✓ |

---

## Deployment

**Immediate Actions:**
1. Redeploy Worker or re-run `compute_taostats_aggregates.py`
2. Next aggregation job will compute with new logic
3. Volume Card will show RED for structural declines

**Testing:**
- Monitor your live Volume Card
- Should now show RED (since 1-day MA is -3.41%)
- Tooltip confirms: "Δ vs MA (1day): -3.41%, confidence: low"

---

## Context: Why This Matters

Volume trends tell a story:
- **250M → 80M** is a structural market shift, not weekend noise
- Alerts should catch this early, not wait for 100min MA to also collapse
- Your seismograph now correctly identifies the earthquake, not just the aftershocks

---

## Notes

- No breaking changes to API response format
- All existing clients continue to work
- Frontend consumes the updated `trend_direction` automatically

---

## Rollback

If needed, revert to RC7.0 with `git checkout v1.0.0-rc.7`
